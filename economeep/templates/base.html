{% load staticfiles %}
{% load compress %}

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>{% block title %}economeep{% endblock title %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    {% compress js %}
    <script src="{% static "js/lib/jquery-1.9.1.min.js" %}" type="text/javascript" charset="utf-8"></script>

    <script src="{% static "js/lib/bootstrap-2.3.1.min.js" %}" type="text/javascript" charset="utf-8"></script>

    <script src="{% static "js/lib/angular-1.1.4.min.js" %}" type="text/javascript" charset="utf-8"></script>
    <script src="{% static "js/lib/angular-resource.min.js" %}" type="text/javascript" charset="utf-8"></script>
    <script src="{% static "js/lib/angular-ui.min.js" %}" type="text/javascript" charset="utf-8"></script>
    <script src="{% static "js/lib/ui-bootstrap-0.2.0.min.js" %}" type="text/javascript" charset="utf-8"></script>

    <script src="{% static "coffee/app.coffee" %}" type="text/coffeescript" charset="utf-8"></script>

    <script src="{% static "coffee/resources/payments.coffee" %}" type="text/coffeescript" charset="utf-8"></script>
    <script src="{% static "coffee/resources/stocks.coffee" %}" type="text/coffeescript" charset="utf-8"></script>

    <script src="{% static "coffee/controllers/payment_list.coffee" %}" type="text/coffeescript" charset="utf-8"></script>
    <script src="{% static "coffee/controllers/stock_list.coffee" %}" type="text/coffeescript" charset="utf-8"></script>

    {% block js %}{% endblock js %}
    {% endcompress %}

    {% compress css %}
    <link href="{% static "css/bootstrap.min.css" %}" rel="stylesheet" type="text/css">
    <link href="{% static "css/bootstrap-responsive.min.css" %}" rel="stylesheet" type="text/css">
    {% endcompress %}
  </head>

  <body ng-app="economeep" data-csrftoken="{{ csrf_token }}" ng-controller="PaymentListCtrl">
    <div class="container">
        {% verbatim %}

        <div ng-show="logged_in">
            Logged in as {{ user.first_name }} {{ user.last_name }}
            <button class="btn btn-small" ng-click="logOut()">Log out</button>

            <div>
                <h2>10 latest payments</h2>

                 <ul ng-show="payments.length">
                    <li ng-repeat="payment in payments">
                        {{ payment.description }} <b>{{ payment.amount }}</b>
                    </li>
                </ul>

                <button class="btn btn-success" ng-click="addPayment()">
                    Add new payment
                </button>

                {{ payment_form }}
            </div>
        </div>


        <div ng-controller="StockListCtrl">
            <h2>Some stocks</h2>
             <ul>
                <li ng-repeat="stock in stocks">
                    {{ stock.name }}
                    <p>{{ stock.short_name }}</p>
                </li>
            </ul>
        </div>

        {% endverbatim %}

        <div ng-hide="logged_in">
            <a href="{% url "socialauth_begin" "facebook" %}" class="btn btn-primary">Login with Facebook</a>
        </div>
    </div>

    {% verbatim %}

    <script type="text/ng-template" id="addPaymentForm">
    <div ng-controller="AddPaymentController">
        <div class="modal-header">
            <h3>New payment</h3>
        </div>
        <div class="modal-body">
            <form>
                {{ payment.amount }}
                <ul class="vertical_form">
                    <li>
                        <label for="amount">Belopp</label>
                        <input name="amount" type="text" ng-model="payment.amount">
                    </li>
                </ul>
            </form>
        </div>
        <div class="modal-footer">
            <button ng-click="close()" class="btn">Close</button>
        </div>
    </div>
    </script>
    {% endverbatim %}
  </body>
</html>
